\subsection{Vorstellung der Scatter funktion} \label{vorstellung}

Um die Probleme der \textit{scatter} Funktion lösen zu können, 
wird dessen Funktionsweise vorgestellt.

Dessen Aufgabe ist es, werte aus einem mehr dimensionalen Array 
in ein anders Array ähnlicher Größe zuschreiben 
und dabei auf alle in eine Zelle geschriebenen werte eine Operation anzuwenden.


Es können zum Beispiel mehrere eingaben in einen Knoten eines Graphen, 
welcher in Matrix form aufgestellt wurde,
zusammen gerechnet werden.

Die Besonderheit der \textit{scatter}-Funktion ist dabei, 
dass dies nicht nur für eine Zelle geschieht, sonder für alle.

Diese ist wie folgt definiert:

\begin{lstlisting}{language=Julia}
	"""
	op ist die operation die auf alle werte die in die selbe 
	    zelle geschrieben werden angewendet wird.
		Moegliche werte sind +, -, *, /, min, max, mean.
	src ist eine beliebige Matrix aus der wert gelesen 
	    und wieder an anderer stelle zurück geschrieben werden.
	idx ist ebenfalls eine beliebige matrix aus der entnommen wird,
	    an welche position, der wert einer zelle geschrieben werden soll.
	init beschreibt wie das ziel array initialisiert wird.
	     Dies kann zum Beispiel genutzt werden, 
		 um den Inhalt des arrays in das geschrieben wird, 
		 initial auf null zu setzten.
	dstsize gibt die groeße des zurück gegebenen arrays an.
	"""

	function scatter(op, src, idx; [init, dstsize])
		dst = similar(src)
		
		fill!(dst, init)
		
		scatter!(op, dst, src, idx)
	end
\end{lstlisting}

Die Implementierung der \textit{scatter} Funktion ist eine vereinfachte Darstellung, 
welche Details zur Berechnung der Größe des \textit{dst} Array weglässt.
Die gesamte Implementierung kann in der \scatter{NNlib.jl} Bibliothek \cite{} nach geschlagen werden.
Wichtig an der Implementierung ist, dass die \textit{similar} Funktion verwendet wird, um das
\textit{dst} Array zu erstellen.
Dieser Aufruf stellt sicher das \textit{dst} und \textit{src} denselben Datentyp haben.
Dies hat den großen Vorteil, 
dass die beiden Argumente der \textit{op} Operation von Gleichen Datentyp sind.
Dies verhindert, 
dass viele Spezialfälle der Addition von Dualzahlen nicht implementiert werden müssen.
Es fällt außerdem auf das die Implementierung der Berechnung innerhalb der \textit{scatter!} Funktion
durchgeführt wird.
Das Ausrufezeichen im Funktionsnamen bedeutet, das die Argumente der Funktion überschrieben werden können.
Die \textit{NNlibCuda.jl} Bibliothek überlädt diese Funktion für \textit{CUDA}-Arrays und
implementiert die Berechnung auf der Grafikkarte.
Innerhalb dieser Implementierung tritt der Fehler auf, der die Verwendung von \textit{Dual}-Zahlen
verhindert.